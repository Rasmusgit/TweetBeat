<html>
  <head>
  <script language="javascript" src="resources/p5.min.js"></script>
  <script src="resources/p5.gibber.min.js" type="text/javascript" charset="utf-8"></script>
  <script language="javascript" src="sketch.js"></script>
  <link rel="stylesheet" href="../resources/examples.css">
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
  <style> body {padding: 0; margin: 0;} </style>
  <link rel="stylesheet" href="../resources/monokai_sublime.css">
  <script src="../resources/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
   

      <script>
          var api_key = "a8d67c385959aa0b15540e2fde6c994a";
          var emotions = ["anger", "joy", "fear", "sadness", "surprise"];
    
          $(document).ready(function(){
   
  
          var txt = $('#text');
          txt.keypress(
          
              function (e){
                  if(e.which == 13){

                      var textInput = txt.val();
          
                      console.log(textInput);
          
                      // batch example
                      $.post(
                        'https://apiv2.indico.io/emotion/batch',
                        JSON.stringify({
                          'api_key': api_key,
                          'data': [textInput],
                          'threshold': 0.1
                        })
                      ).then(function(res) {
                        var response = res.results[0]; //(fear: 0.23123, joy:0.32231)
                        var greatestEmotion = ""//fear: 0.23123
          
                        for(i=0;i<emotions.length;i++){
                          if(response.hasOwnProperty(emotions[i])){
                            console.log("We made it!");
                            if(greatestEmotion == "" || response[emotions[i]]>=response[greatestEmotion]){
                              greatestEmotion = emotions[i];
                            }
                          }
                          
                        }
                        console.log(response);
                        console.log(greatestEmotion);
                        $("#emRes").text(greatestEmotion);
                      });

                  }
        
              });
  
          });
   
        </script>

  </head>

  <body>

    <textarea id="text"></textarea>

    <p>Emotion:</p>
    <p id="emRes"></p>

  </body>
</html>
